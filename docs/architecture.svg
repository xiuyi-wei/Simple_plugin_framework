<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="700" viewBox="0 0 1000 700">
  <style>
    .pkg { fill:#f5f7ff; stroke:#4a6cff; stroke-width:2px; rx:6; }
    .title { font: bold 16px sans-serif; fill:#10356a }
    .cls { fill:#ffffff; stroke:#888888; stroke-width:1px; rx:4 }
    .label { font: 12px sans-serif; fill:#222 }
    .arrow { stroke:#222; stroke-width:1.6; fill:none; marker-end:url(#arrowhead) }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#222" />
    </marker>
  </defs>

  <!-- core package -->
  <rect x="40" y="40" width="420" height="240" class="pkg" />
  <text x="60" y="64" class="title">core</text>
  <rect x="60" y="84" width="160" height="36" class="cls" />
  <text x="70" y="106" class="label">IObject</text>
  <rect x="60" y="130" width="160" height="36" class="cls" />
  <text x="70" y="152" class="label">ISimple</text>
  <rect x="240" y="84" width="210" height="82" class="cls" />
  <text x="250" y="106" class="label">PluginManager</text>
  <text x="250" y="124" class="label">loadPlugin / registerClass</text>

  <!-- app package -->
  <rect x="520" y="40" width="420" height="120" class="pkg" />
  <text x="540" y="64" class="title">app</text>
  <rect x="540" y="88" width="180" height="36" class="cls" />
  <text x="550" y="110" class="label">main.cpp</text>

  <!-- plugins package -->
  <rect x="520" y="200" width="420" height="160" class="pkg" />
  <text x="540" y="224" class="title">plugins</text>
  <rect x="560" y="252" width="300" height="36" class="cls" />
  <text x="570" y="274" class="label">simple / SimplePlugin</text>
  <text x="570" y="292" class="label">registerPlugin(PluginManager&)</text>

  <!-- arrows -->
  <path d="M 455 130 L 520 110" class="arrow" />
  <text x="470" y="100" class="label">uses</text>

  <path d="M 580 140 L 580 252" class="arrow" />
  <text x="600" y="190" class="label">loadPlugin -> LoadLibrary/dlopen</text>

  <path d="M 700 288 L 460 170" class="arrow" />
  <text x="580" y="240" class="label">registerPlugin() calls registerClass()</text>

  <path d="M 460 200 L 720 166" class="arrow" />
  <text x="520" y="180" class="label">factory stored (std::shared_ptr&lt;IObject&gt;)</text>

  <!-- sequence hint -->
  <rect x="40" y="310" width="900" height="340" fill="#fff8e6" stroke="#c68c00" rx="6" />
  <text x="60" y="338" class="title">Runtime sequence (simplified)</text>
  <text x="80" y="364" class="label">main -> PluginManager: loadPlugin(path)</text>
  <text x="80" y="384" class="label">PluginManager -> OS: LoadLibrary / dlopen</text>
  <text x="80" y="404" class="label">OS -> plugin: invoke registerPlugin()</text>
  <text x="80" y="424" class="label">plugin -> PluginManager: registerClass("clsid", factory)</text>
  <text x="80" y="444" class="label">main -> PluginManager: create("clsid") -> factory() -> IObject</text>
  <text x="80" y="464" class="label">main: dynamic_cast to ISimple and call add(a,b)</text>

</svg>
